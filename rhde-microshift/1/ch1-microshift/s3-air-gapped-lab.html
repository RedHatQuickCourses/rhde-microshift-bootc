<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lab: Prepare a Test Environment for MicroShift :: Deploying MicroShift on Image Mode for RHEL</title>
    <link rel="prev" href="s2-prepare-lab.html">
    <link rel="next" href="s4-summary.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Deploying MicroShift on Image Mode for RHEL</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/rhde-microshift-bootc/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rhde-microshift" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Deploying MicroShift on Red Hat Device Edge</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Introduction to Red Hat Build of MicroShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="s1-microshift-vs-ocp.html">Introduction to MicroShift and Red Hat Device Edge</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="s2-prepare-lab.html">Lab: Prepare a Test Environment for Red Hat Device Edge</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="s3-air-gapped-lab.html">Lab: Prepare a Test Environment for MicroShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="s4-summary.html">Summary</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ch2-package/index.html">Deploy MicroShift on RHEL Servers</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch2-package/s1-install-config.html">Install and Configure MicroShift on Package-Based RHEL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch2-package/s2-install-lab.html">Lab: Install MicroShift from RPM Packages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch2-package/s3-access-lab.html">Lab: Access MicroShift as a Developer or Platform Engineer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch2-package/s4-apps-lab.html">Lab: Deploy Kubernetes Applications in MicroShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch2-package/s5-summary.html">Summary</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ch3-image/index.html">Deploy MicroShift on Edge Devices</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch3-image/s1-microshift-edge.html">RHEL for Edge images With MicroShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch3-image/s2-image-lab.html">Lab: Create RHEL for Edge Images with MicroShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch3-image/s4-summary.html">Summary</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Deploying MicroShift on Red Hat Device Edge</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../rhde-microshift-bootc/1/index.html">Deploying MicroShift on Image Mode for RHEL</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../rhde-microshift-bootc/1/index.html">1</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">Deploying MicroShift on Red Hat Device Edge</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../samples/1/index.html">samples</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../samples/1/index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../rhde-microshift-bootc/1/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Deploying MicroShift on Red Hat Device Edge</a></li>
    <li><a href="index.html">Introduction to Red Hat Build of MicroShift</a></li>
    <li><a href="s3-air-gapped-lab.html">Lab: Prepare a Test Environment for MicroShift</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Lab: Prepare a Test Environment for MicroShift</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><em>Estimated reading time: <strong>9 minutes</strong>.</em></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Objective</dt>
<dd>
<p>Prepare a test environment for air-gaped deployment of MicroShift in both package-based RHEL and RHEL for Edge.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_before_you_begin"><a class="anchor" href="#_before_you_begin"></a>Before you Begin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You need a few machines to perform the hands-on activities in this course.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <em>development machine</em> with RHEL and unrestricted <code>sudo</code>, where you will install Image Builder and RPM-OSTree tools, create test VMs using Libvirt, and also run the OpenShift client to access your MicroShift instances in other machines.</p>
</li>
<li>
<p>A <em>test machine</em> with RHEL and unrestricted <code>sudo</code>, where you will install MicroShift on package-based RHEL.</p>
</li>
<li>
<p>A <em>package server machine</em> already configured to serve DNF repositories for RHEL, Fast Datapath for RHEL, and Red Hat OpenShift Container Platform.</p>
</li>
<li>
<p>A <em>web server machine</em> with RHEL and unrestricted <code>sudo</code>, to host OSTree repositories</p>
</li>
<li>
<p>A <em>mirror registry machine</em> with RHEL and unrestricted <code>sudo</code>, to host a <a href="https://www.redhat.com/en/blog/introducing-mirror-registry-for-red-hat-openshift">mirror registry for Red Hat OpenShift</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These instructions were tested on RHEL 9.5 but should work with minimal or no change on newer and older RHEL 9.x releases.</p>
</div>
<div class="paragraph">
<p>If you are using the course environment, you will log in to the <code>workstation</code> VM as the user <code>student</code> with password <code>student</code>. The <code>workstation</code> VM is your <em>development machine</em>. You will start SSH sessions from the <code>workstation</code> VM to the <code>servera</code> VM, which is your <em>web server machine</em> and also your <em>mirror registry machine</em>, using the same user.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Be sure you execute each step on the correct machine. If a step is not explicit about the machine it should be performed, it is using the same machine as its previous step.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the course environment, the <code>classroom</code> VM, with the <code>materials</code> alias, is your <em>package server machine</em> but you are <em>not</em> expected to start SSH sessions nor perform any activity on it.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It should be possible to perform all activities in this course using a <a href="https://developers.redhat.com/products/rhel/download">free Red Hat Developers free subscrition</a>, which gives you access to installation media, RPM packages, and container images for RHEL and Red Hat OpenShift. If you ignore the requirements for air-gaped installation of MicroShift, you could use a single RHEL VM and adapt the steps to your own environment.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_instructions"><a class="anchor" href="#_instructions"></a>Instructions</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure your <em>web server machine</em> with a mirror registry for Red Hat OpenShift.</p>
<div class="paragraph">
<p>These steps are required for all kinds of MicroShift deployment, be they on package-based or image-based, if you are performing air-gaped deployments.</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The mirror registry for OpenShift runs as a local container, so install Podman and the Linux container tools.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>sudo dnf install container-tools</strong>
...
Complete!</code></pre>
</div>
</div>
</li>
<li>
<p>Allow remote access to the mirror registry on the system firewall.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>sudo firewall-cmd --add-port=8443/tcp --permanent</strong>
success
$ <strong>sudo firewall-cmd --reload</strong>
success</code></pre>
</div>
</div>
</li>
<li>
<p>Download the installer for mirror registry for Red Hat OpenShift.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In a connected environment, you would get it from the <a href="https://console.redhat.com/openshift/downloads#tool-mirror-registry">downloads</a> page of the Red Hat Hybrid Cloud Console, but there is already a copy of the installer in the course environment at http://content.example.com/rhde/rhocp/.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>wget -q http://content.example.com/rhde/rhocp/mirror-registry-amd64.tar.gz</strong></code></pre>
</div>
</div>
</li>
<li>
<p>Extract the mirror registry installer in a temporary directory. You may want to keep the directory for later, if you need to uninstall the mirror registry.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>mkdir mirror-registry</strong>
$ <strong>tar xzvf mirror-registry-amd64.tar.gz -C mirror-registry</strong>
image-archive.tar
execution-environment.tar
mirror-registry
sqlite3.tar</code></pre>
</div>
</div>
</li>
<li>
<p>Run the mirror registry installer.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>sudo ./mirror-registry/mirror-registry install -v --quayHostname servera.lab.example.com  --quayRoot /var/quay --initUser microshift --initPassword redhat123</strong>
...
INFO[2024-12-19 15:29:40] Quay installed successfully, config data is stored in /var/quay
INFO[2024-12-19 15:29:40] Quay is available at https://servera.lab.example.com:8443 with credentials (microshift, redhat123)</code></pre>
</div>
</div>
</li>
<li>
<p>If something goes wrong and you must retry the mirror registry installation, first clean the failed installation using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>sudo ./mirror-registry/mirror-registry uninstall -v --quayRoot /var/quay --autoApprove</strong>
...
INFO[2024-12-19 15:25:41] Quay uninstalled successfully</code></pre>
</div>
</div>
</li>
<li>
<p>If all is well, you should have three new containers, and three new system services.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>sudo podman ps</strong>
CONTAINER ID  IMAGE                                         COMMAND     CREATED      STATUS      PORTS                   NAMES
c4fee96c05e0  registry.access.redhat.com/ubi8/pause:8.10-5  infinity    5 hours ago  Up 5 hours  0.0.0.0:8443-&gt;8443/tcp  3e6c474403ac-infra
48a7e7a330dc  registry.redhat.io/quay/quay-rhel8:v3.12.2    registry    5 hours ago  Up 5 hours  0.0.0.0:8443-&gt;8443/tcp  quay-app
82b8559fcc97  registry.redhat.io/rhel8/redis-6:1-190        run-redis   5 hours ago  Up 5 hours  0.0.0.0:8443-&gt;8443/tcp  quay-redis
$ <strong>systemctl status quay-app</strong>
● quay-app.service - Quay Container
     Loaded: loaded (/etc/systemd/system/quay-app.service; enabled; preset: disabled)
     Active: active (running) since Fri 2024-12-20 09:04:13 EST; 5h 19min ago
...
$ <strong>systemctl status quay-redis</strong>
● quay-redis.service - Redis Podman Container for Quay
     Loaded: loaded (/etc/systemd/system/quay-redis.service; enabled; preset: disabled)
     Active: active (running) since Fri 2024-12-20 09:04:13 EST; 5h 19min ago
...
...
$ <strong>systemctl status quay-pod</strong>
● quay-pod.service - Infra Container for Quay
     Loaded: loaded (/etc/systemd/system/quay-pod.service; enabled; preset: disabled)
     Active: active (exited) since Mon 2025-04-28 16:35:15 EDT; 2h 9min ago
   Main PID: 33761 (code=exited, status=0/SUCCESS)
        CPU: 100ms
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is expected that the <code>quay-pod</code> system service runs once and exits.</p>
</div>
</li>
<li>
<p>Publish the CA certificate of the mirror registry on the Apache Web Server, so other machines can download it and connect to the mirror registry without disabling TLS validation.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>sudo cp /var/quay/quay-rootCA/rootCA.pem /var/www/html/quay-rootCA.pem</strong></code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Configure your <em>development machine</em> to access your mirror registry.</p>
<div class="paragraph">
<p>We will install MicroShift with common assumptions of air-gaped environments, where MicroShift should only pull container images that were previously vetted and only from private container registries, which in the course environment is the mirror registry.</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Install the RHEL container tools because you need more than just Podman.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>sudo dnf install container-tools</strong>
...
Complete!</code></pre>
</div>
</div>
</li>
<li>
<p>Add the CA certificate of the mirror registry to your system trusted certificates.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>wget -q http://servera.lab.example.com/quay-rootCA.pem</strong>
$ <strong>sudo cp quay-rootCA.pem /etc/pki/ca-trust/source/anchors</strong>
$ <strong>sudo update-ca-trust</strong></code></pre>
</div>
</div>
</li>
<li>
<p>Log in to the mirror registry.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>podman login -u microshift -p redhat123 https://servera.lab.example.com:8443</strong>
Login Succeeded!</code></pre>
</div>
</div>
</li>
<li>
<p>Copy your registry authentication credentials to a pull secret file.</p>
<div class="paragraph">
<p>This file replaces the pull secret of your Red Hat account, that you would use to install OpenShift and MicroShift when connected to the internet.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>cp $XDG_RUNTIME_DIR/containers/auth.json mirror-pull-secret</strong></code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
You will later copy this file to your MicroShift instances, so it is important that it contains only credentials to the mirror registry, and nothing else. If you configured your mirror registry with exactly the same user name and password from the previous step, you can download a <a href="https://github.com/RedHatQuickCourses/rhde-build-samples/blob/main/microshift/mirror-pull-secret">sample pull secret file</a> from the course samples repository and just edit the host name of your mirror registry.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Download a file system copy of all required container images from the classroom server.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When outside of the course environment, follow the instructions from <a href="https://docs.redhat.com/en/documentation/red_hat_build_of_microshift/4.17/html/embedding_in_a_rhel_for_edge_image/microshift-deploy-with-mirror-registry">product docs</a> to extract a list of MicroShift release images from the <code>microshift-release-info</code> RPM package and download them to a staging directory. In the course environment, we provide you with a backup of the staging directory to avoid the need for internet access and save on cloud bandwidth fees.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>wget -q http://content.example.com/rhde/oci/microshift-containers.tar.gz</strong>
$ <strong>tar xzf microshift-containers.tar.gz</strong>
$ <strong>ls microshift-containers/</strong>
lvms4  openshift-release-dev
$ <strong>wget -q http://content.example.com/rhde/oci/app-containers.tar.gz</strong>
$ <strong>tar xzf app-containers.tar.gz</strong>
$ <strong>ls app-containers</strong>
extra-images-list.txt  flozanorht  rhel9  ubi9</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Populate the mirror registry with container images required by MicroShift.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Download the <a href="https://github.com/RedHatQuickCourses/rhde-build-samples/blob/main/sh/upload-microshift.sh">MicroShift images upload script</a>. It is based on the script provided by <a href="https://docs.redhat.com/en/documentation/red_hat_build_of_microshift/4.17/html/embedding_in_a_rhel_for_edge_image/index">product documentation</a>, with minor edits.</p>
<div class="paragraph">
<p>Please use the copy of the script in the course samples repository as product documentation may change after this course was released.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>wget -q https://raw.githubusercontent.com/RedHatQuickCourses/rhde-build-samples/refs/heads/main/sh/upload-microshift.sh</strong></code></pre>
</div>
</div>
</li>
<li>
<p>Run the MicroShift images upload script. Check carefully that its output does not indicate any errors.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>sh upload-microshift.sh</strong></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
OpenShift release images, which are reused by MicroShift, are not identified by a tag. You must refer to them by hash, so they look like different builds of the same <code>openshift-release-dev/ocp-v4.0-art-dev</code> image but they are actually completely different images.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>You can check that the upload process worked by listing all images in the mirror registry.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>podman search servera.lab.example.com:8443/</strong>
NAME                                                                 DESCRIPTION
servera.lab.example.com:8443/lvms4/lvms-rhel9-operator
servera.lab.example.com:8443/openshift-release-dev/ocp-v4.0-art-dev</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The OCI distribution API is very unreliable for searching and listing container images in a container registry. It works here because there are very few images, but may not work in a production private registry with a larger number of images, including a complete set of images for Red Hat OpenShift.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Populate the mirror registry with container images required by sample applications for course activities.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Download the <a href="https://github.com/RedHatQuickCourses/rhde-build-samples/blob/main/sh/upload-apps.sh">application images upload script</a>. It is very similar to the MicroShift images upload script.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>wget -q https://raw.githubusercontent.com/RedHatQuickCourses/rhde-build-samples/refs/heads/main/sh/upload-apps.sh</strong></code></pre>
</div>
</div>
</li>
<li>
<p>Run the application images upload script. Check carefully that its output does not indicate any errors.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>sh upload-apps.sh</strong></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In production environments, it is not recommended that you mirror images based on floating tags, such as the implicit <code>latest</code> image tag, like we did here. It is recommended that you mirror using non-floating tags or image hashes.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>You can check that the upload process worked by listing all images in the mirror registry.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ <strong>podman search servera.lab.example.com:8443/</strong>
NAME                                                                 DESCRIPTION
servera.lab.example.com:8443/lvms4/lvms-rhel9-operator
servera.lab.example.com:8443/openshift-release-dev/ocp-v4.0-art-dev
servera.lab.example.com:8443/rhel9/mysql-80
servera.lab.example.com:8443/flozanorht/php-ubi
servera.lab.example.com:8443/ubi9/ubi</code></pre>
</div>
</div>
</li>
<li>
<p>Alternatively, you can open the web GUI of Red Hat Quay at <code><a href="https://servera.lab.example.com:8443/" class="bare">https://servera.lab.example.com:8443/</a></code> and browse the images available in your mirror registry.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The mirror registry for Red Hat OpenShift only supports a subset of the features of Red Hat Quay and it is not configured for reliability and high availability.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Check that your <em>package server machine</em> is already set up with all artifacts required for air-gaped installation of MicroShift. These steps are required for all kinds of MicroShift deployments, be they on package-based or image-based, if you are performing air-gaped deployments.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In production environments, it is recommended that you deploy Red Hat Satellite to mirror RPM package repositories from Red Hat products, but the course environment uses an Apache Web Server.
</td>
</tr>
</table>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Open <code><a href="http://content.example.com/rhel9.5/x86_64/dvd/" class="bare">http://content.example.com/rhel9.5/x86_64/dvd/</a></code> in a web browser. This directory is a copy of a RHEL offline installation DVD and contains the <code>baseos</code> and <code>appstreams</code> repositories.</p>
</li>
<li>
<p>Open <code><a href="http://content.example.com/rhde/rpms/" class="bare">http://content.example.com/rhde/rpms/</a></code> in a web browser. This directory contains a copy of the Red Hat OpenShift and Fast Datapath for RHEL repositories, created using the <code>reposync</code> command.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>You now have your <em>mirror registry machine</em> and your <em>package server machine</em> ready to support the air-gaped deployment of MicroShift in both package-based RHEL and in RHEL for Edge images.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_whats_next"><a class="anchor" href="#_whats_next"></a>What&#8217;s Next</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The next chapter features a series of hands-on activities that deploy MicroShift on a RHEL VM and configure unprivileged developer-level access to it.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="s2-prepare-lab.html">Lab: Prepare a Test Environment for Red Hat Device Edge</a></span>
  <span class="next"><a href="s4-summary.html">Summary</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
